{
  "notes": "adversarial domain adaptation",
  "model_base_path": "s3://mobileye-habana/mobileye-team-stereo/models",
  "model_params": {
    "arch": {
      "name": "stereo/sdsv3_v0.5.5_stereo_corr_diet_adversarial_scale",
      "kwargs": {
        "batch_norm": 0,
        "min_Z": 1.0,
        "max_Z": 1000.0,
        "regularization" : "l2",
        "adv_gradient_scale": -1.0,
        "adv_drop_out_rate": 0.0
      },
      "map_func_kwargs": {
        "main": {
          "num_steps_corr": 45,
          "min_Z_corr": 2.0,
          "max_Z_corr": 500.0,
          "min_delta_Z_corr": 0.1,
          "domain": 0
        },
        "main_sim": {
          "num_steps_corr": 45,
          "min_Z_corr": 2.0,
          "max_Z_corr": 500.0,
          "min_delta_Z_corr": 0.1,
          "domain": 1
        }
      }
    },
    "loss": {
      "name": "stereo/sim_v0.0.1.adversarial",
      "kwargs": {
        "alpha_sim": 10.0,
        "alpha_adv": 1.0,
        "kernel_reg_constant" : 0.005,
        "label_smoothing": 0.0
      },
      "map_func_kwargs": {
        "main": {"domain": 0},
        "main_sim": {"domain": 1}
      }
    },
    "optimizers": {
      "opt_adversarial": {
        "optimizer_type": "AdamOptimizer",
        "learning_rate" : 3e-7,
        "vars_regex": ".*adv.*",
        "loss": "loss_adv"
      },
      "opt_generator_gen": {
        "optimizer_type": "AdamOptimizer",
        "learning_rate" : 5e-4,
        "vars_regex": "^(?!.*adv.*)",
        "loss": "loss_gen"
      },
      "opt_generator_adv": {
        "optimizer_type": "AdamOptimizer",
        "learning_rate" : 1e-5,
        "vars_regex": "^(?!.*adv.*)",
        "loss": "loss_gen_adv"
      }
    },
    "init": {
      "warm_start": {
        "model_name": "diet_main_v3.0.v0.0.12",
        "restore_iter": 270000,
        "vars_to_warm_start": "^(?!.*adv.*)"
      }
    },
    "freeze_layers": [
      "arch/corr_features"
    ],
    "strings_to_summarize": [
      "features/sample_id"
    ],
    "scalars_to_summarize": [
      "loss/loss_sim",
      "loss/loss_short_on_real",
      "loss/loss_adv",
      "loss/loss_kernel_reg",
      "loss/loss"
    ],
    "images_to_summarize": [
      "features/I_cntr",
      "features/I_srnd_0",
      "features/I_srnd_1",
      "features/I_srnd_2",
      "features/sim_depth_inv",
      "arch/out"
    ],
    "reverse_image_summaries": true,
    "with_model_scoping": true,
    "scalars_to_log": [
      "loss/loss_sim",
      "loss/loss_short_on_real",
      "loss/loss_adv",
      "loss/loss"
    ]
  },
  "data_params": {
    "datasets": {"main":  "main.v3.1.3", "main_sim":  "sim.v4.main"},
    "weights": {"main": 0.5, "main_sim": 0.5},
    "augmentation": {
      "main_sim": {
        "name": "mask_corners",
        "kwargs": {
          "margin_range": 15
        }
      }
    }
  }
}
